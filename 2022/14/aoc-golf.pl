perl -nE 'BEGIN{$ENV{A}&&print"\033[2J\033[0;0H";$mx=$Mx=500;}@n=m!(\d+)!g;($x,$y)=(shift@n,shift@n);$m{$x,$y}="#"; while(@n){($nx,$ny)=(shift@n,shift@n);while($x!=$nx||$y!=$ny){$x<$nx&&$x++||$x>$nx&&$x--;$y<$ny&&$y++||$y>$ny&&$y--;$m{$x,$y}="#";$mx=$x if$mx>$x;$Mx=$x if$Mx<$x;$My=$y if$My<$y;}}END{$_=("_"x(500-$mx+$My))."+".("_"x($Mx-500+$My)).$/;$w=1+$Mx-$mx+$My*2;$wm=$w-1;$wM=$w+1;for$y(0..$My+1){for$x($mx-$My..$Mx+$My){$_.=$m{$x,$y}//".";}$_.=$/;}$E=$My-1;$c=0;while(s/\+.{$w}\K\./o/s){$c++;while(s/o(.{$w})\./.$1o/s||s/o(.{$wm})\./.$1o/s||s/o(.{$wM})\./.$1o/s){};$p1=$c-1 if (!$p1&&(/^.{$E}o/m||/o.{$E}$/m));$ENV{A}&&do{say;print"\033[0;0H";select$u,$u,$u,0.1}}say"Part 1: $p1\nPart 2: $c";}' ${1:-input.txt}
