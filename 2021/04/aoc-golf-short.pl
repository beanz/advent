#!/bin/sh
exec \
/usr/bin/perl -0plne '$_.="\n\n";s/\n\n/\n!\n/g;s/\n/,\n/;$n="";s&(\d+),?&$c=$1;s/\b$c\b/$c>9?" X":"X"/ge;s/(\n!\n(?:(?:[^!]*?X +X +X +X +X\n?[^!]*?)|(?: X +?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+\n X +?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+\n X +?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+\n X +?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+\n X +?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+)|(?: ?[\dX]+ +X +[\dX]+ +[\dX]+ +[\dX]+\n ?[\dX]+ +X +[\dX]+ +[\dX]+ +[\dX]+\n ?[\dX]+ +X +[\dX]+ +[\dX]+ +[\dX]+\n ?[\dX]+ +X +[\dX]+ +[\dX]+ +[\dX]+\n ?[\dX]+ +X +[\dX]+ +[\dX]+ +[\dX]+)|(?: ?[\dX]+ +[\dX]+ +X +[\dX]+ +[\dX]+\n ?[\dX]+ +[\dX]+ +X +[\dX]+ +[\dX]+\n ?[\dX]+ +[\dX]+ +X +[\dX]+ +[\dX]+\n ?[\dX]+ +[\dX]+ +X +[\dX]+ +[\dX]+\n ?[\dX]+ +[\dX]+ +X +[\dX]+ +[\dX]+)|(?: ?[\dX]+ +[\dX]+ +[\dX]+ +X +[\dX]+\n ?[\dX]+ +[\dX]+ +[\dX]+ +X +[\dX]+\n ?[\dX]+ +[\dX]+ +[\dX]+ +X +[\dX]+\n ?[\dX]+ +[\dX]+ +[\dX]+ +X +[\dX]+\n ?[\dX]+ +[\dX]+ +[\dX]+ +X +[\dX]+)|(?: ?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+ +X\n ?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+ +X\n ?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+ +X\n ?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+ +X\n ?[\dX]+ +[\dX]+ +[\dX]+ +[\dX]+ +X)))\n!\n/$b=$1;$s=0;$b=~s!(\d+)\s*!$s+=$1;"X"!eg;$n.=($c*$s).";";"\n!\n";/seg;""&seg;$_=$n;s/.*\n//s;s/;$/\n/;s/;.*;/\nPart 2: /;$_="Part 1: ".$_;' "$@"
